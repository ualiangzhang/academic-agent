"use strict";var __runInitializers=exports&&exports.__runInitializers||function(thisArg,initializers,value){for(var useValue=arguments.length>2,i=0;i<initializers.length;i++)value=useValue?initializers[i].call(thisArg,value):initializers[i].call(thisArg);return useValue?value:void 0},__esDecorate=exports&&exports.__esDecorate||function(ctor,descriptorIn,decorators,contextIn,initializers,extraInitializers){function accept(f){if(f!==void 0&&typeof f!="function")throw new TypeError("Function expected");return f}for(var kind=contextIn.kind,key=kind==="getter"?"get":kind==="setter"?"set":"value",target=!descriptorIn&&ctor?contextIn.static?ctor:ctor.prototype:null,descriptor=descriptorIn||(target?Object.getOwnPropertyDescriptor(target,contextIn.name):{}),_,done=!1,i=decorators.length-1;i>=0;i--){var context={};for(var p in contextIn)context[p]=p==="access"?{}:contextIn[p];for(var p in contextIn.access)context.access[p]=contextIn.access[p];context.addInitializer=function(f){if(done)throw new TypeError("Cannot add initializers after decoration has completed");extraInitializers.push(accept(f||null))};var result=(0,decorators[i])(kind==="accessor"?{get:descriptor.get,set:descriptor.set}:descriptor[key],context);if(kind==="accessor"){if(result===void 0)continue;if(result===null||typeof result!="object")throw new TypeError("Object expected");(_=accept(result.get))&&(descriptor.get=_),(_=accept(result.set))&&(descriptor.set=_),(_=accept(result.init))&&initializers.unshift(_)}else(_=accept(result))&&(kind==="field"?initializers.unshift(_):descriptor[key]=_)}target&&Object.defineProperty(target,contextIn.name,descriptor),done=!0};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SingletonFunction=void 0;var jsiiDeprecationWarnings=()=>{var tmp=require("../../.warnings.jsii.js");return jsiiDeprecationWarnings=()=>tmp,tmp};const JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti");var function_1=()=>{var tmp=require("./function");return function_1=()=>tmp,tmp},function_base_1=()=>{var tmp=require("./function-base");return function_base_1=()=>tmp,tmp},cdk=()=>{var tmp=require("../../core");return cdk=()=>tmp,tmp},metadata_resource_1=()=>{var tmp=require("../../core/lib/metadata-resource");return metadata_resource_1=()=>tmp,tmp},prop_injectable_1=()=>{var tmp=require("../../core/lib/prop-injectable");return prop_injectable_1=()=>tmp,tmp};let SingletonFunction=(()=>{let _classDecorators=[prop_injectable_1().propertyInjectable],_classDescriptor,_classExtraInitializers=[],_classThis,_classSuper=function_base_1().FunctionBase,_instanceExtraInitializers=[],_addEnvironment_decorators,_addLayers_decorators,_addPermission_decorators,_addDependency_decorators,_addMetadata_decorators,_dependOn_decorators;var SingletonFunction2=class extends _classSuper{static{_classThis=this}static{const _metadata=typeof Symbol=="function"&&Symbol.metadata?Object.create(_classSuper[Symbol.metadata]??null):void 0;_addEnvironment_decorators=[(0,metadata_resource_1().MethodMetadata)()],_addLayers_decorators=[(0,metadata_resource_1().MethodMetadata)()],_addPermission_decorators=[(0,metadata_resource_1().MethodMetadata)()],_addDependency_decorators=[(0,metadata_resource_1().MethodMetadata)()],_addMetadata_decorators=[(0,metadata_resource_1().MethodMetadata)()],_dependOn_decorators=[(0,metadata_resource_1().MethodMetadata)()],__esDecorate(this,null,_addEnvironment_decorators,{kind:"method",name:"addEnvironment",static:!1,private:!1,access:{has:obj=>"addEnvironment"in obj,get:obj=>obj.addEnvironment},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,_addLayers_decorators,{kind:"method",name:"addLayers",static:!1,private:!1,access:{has:obj=>"addLayers"in obj,get:obj=>obj.addLayers},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,_addPermission_decorators,{kind:"method",name:"addPermission",static:!1,private:!1,access:{has:obj=>"addPermission"in obj,get:obj=>obj.addPermission},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,_addDependency_decorators,{kind:"method",name:"addDependency",static:!1,private:!1,access:{has:obj=>"addDependency"in obj,get:obj=>obj.addDependency},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,_addMetadata_decorators,{kind:"method",name:"addMetadata",static:!1,private:!1,access:{has:obj=>"addMetadata"in obj,get:obj=>obj.addMetadata},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(this,null,_dependOn_decorators,{kind:"method",name:"dependOn",static:!1,private:!1,access:{has:obj=>"dependOn"in obj,get:obj=>obj.dependOn},metadata:_metadata},null,_instanceExtraInitializers),__esDecorate(null,_classDescriptor={value:_classThis},_classDecorators,{kind:"class",name:_classThis.name,metadata:_metadata},null,_classExtraInitializers),SingletonFunction2=_classThis=_classDescriptor.value,_metadata&&Object.defineProperty(_classThis,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_metadata})}static[JSII_RTTI_SYMBOL_1]={fqn:"aws-cdk-lib.aws_lambda.SingletonFunction",version:"2.220.0"};static PROPERTY_INJECTION_ID="aws-cdk-lib.aws-lambda.SingletonFunction";grantPrincipal=__runInitializers(this,_instanceExtraInitializers);functionName;functionArn;role;permissionsNode;architecture;runtime;constructName;canCreatePermissions;lambdaFunction;constructor(scope,id,props){super(scope,id);try{jsiiDeprecationWarnings().aws_cdk_lib_aws_lambda_SingletonFunctionProps(props)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,SingletonFunction2),error}(0,metadata_resource_1().addConstructMetadata)(this,props),this.constructName=(props.lambdaPurpose||"SingletonLambda")+slugify(props.uuid),this.lambdaFunction=this.ensureLambda(props),this.permissionsNode=this.lambdaFunction.node,this.architecture=this.lambdaFunction.architecture,this.functionArn=this.lambdaFunction.functionArn,this.functionName=this.lambdaFunction.functionName,this.role=this.lambdaFunction.role,this.runtime=this.lambdaFunction.runtime,this.grantPrincipal=this.lambdaFunction.grantPrincipal,this.canCreatePermissions=!0}get isBoundToVpc(){return this.lambdaFunction.isBoundToVpc}get connections(){return this.lambdaFunction.connections}get logGroup(){return this.lambdaFunction.logGroup}get currentVersion(){return this.lambdaFunction.currentVersion}get resourceArnsForGrantInvoke(){return[this.functionArn,`${this.functionArn}:*`]}addEnvironment(key,value,options){try{jsiiDeprecationWarnings().aws_cdk_lib_aws_lambda_EnvironmentOptions(options)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.addEnvironment),error}return this.lambdaFunction.addEnvironment(key,value,options)}addLayers(...layers){try{jsiiDeprecationWarnings().aws_cdk_lib_aws_lambda_ILayerVersion(layers)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.addLayers),error}return this.lambdaFunction.addLayers(...layers)}addPermission(name,permission){try{jsiiDeprecationWarnings().aws_cdk_lib_aws_lambda_Permission(permission)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,this.addPermission),error}return this.lambdaFunction.addPermission(name,permission)}addDependency(...up){this.lambdaFunction.node.addDependency(...up)}addMetadata(type,data,options){this.lambdaFunction.node.addMetadata(type,data,options)}dependOn(down){down.node.addDependency(this.lambdaFunction)}_checkEdgeCompatibility(){return this.lambdaFunction._checkEdgeCompatibility()}_functionNode(){return this.lambdaFunction.node}ensureLambda(props){const existing=cdk().Stack.of(this).node.tryFindChild(this.constructName);return existing||new(function_1()).Function(cdk().Stack.of(this),this.constructName,props)}static{__runInitializers(_classThis,_classExtraInitializers)}};return SingletonFunction2=_classThis})();exports.SingletonFunction=SingletonFunction;function slugify(x){return x.replace(/[^a-zA-Z0-9]/g,"")}
